version: '3'
services:
  redis-node-0:
    image: docker.io/bitnami/redis-cluster:7.0
    container_name: redis-node-0
    volumes:
      - redis-cluster_data-0:/bitnami/redis/data
    environment:
      # - 'REDIS_PASSWORD=bitnami'
      - REDIS_PORT_NUMBER=7000
      - ALLOW_EMPTY_PASSWORD=yes
      - 'REDIS_NODES=redis-node-0:7000 redis-node-1:7001 redis-node-2:7002 redis-node-3:7003 redis-node-4:7004 redis-node-5:7005'
    ports:
      - "7000:7000"
    networks:
      - redis-cluster_default

  redis-node-1:
    image: docker.io/bitnami/redis-cluster:7.0
    container_name: redis-node-1
    volumes:
      - redis-cluster_data-1:/bitnami/redis/data
    environment:
      # - 'REDIS_PASSWORD=bitnami'
      - REDIS_PORT_NUMBER=7001
      - ALLOW_EMPTY_PASSWORD=yes
      - 'REDIS_NODES=redis-node-0:7000 redis-node-1:7001 redis-node-2:7002 redis-node-3:7003 redis-node-4:7004 redis-node-5:7005'
    ports:
      - "7001:7001"
    networks:
      - redis-cluster_default

  redis-node-2:
    image: docker.io/bitnami/redis-cluster:7.0
    container_name: redis-node-2
    volumes:
      - redis-cluster_data-2:/bitnami/redis/data
    environment:
      # - 'REDIS_PASSWORD=bitnami'
      - REDIS_PORT_NUMBER=7002
      - ALLOW_EMPTY_PASSWORD=yes
      - 'REDIS_NODES=redis-node-0:7000 redis-node-1:7001 redis-node-2:7002 redis-node-3:7003 redis-node-4:7004 redis-node-5:7005'
    ports:
      - "7002:7002"
    networks:
      - redis-cluster_default

  redis-node-3:
    image: docker.io/bitnami/redis-cluster:7.0
    container_name: redis-node-3
    volumes:
      - redis-cluster_data-3:/bitnami/redis/data
    environment:
      # - 'REDIS_PASSWORD=bitnami'
      - REDIS_PORT_NUMBER=7003
      - ALLOW_EMPTY_PASSWORD=yes
      - 'REDIS_NODES=redis-node-0:7000 redis-node-1:7001 redis-node-2:7002 redis-node-3:7003 redis-node-4:7004 redis-node-5:7005'
    ports:
      - "7003:7003"
    networks:
      - redis-cluster_default

  redis-node-4:
    image: docker.io/bitnami/redis-cluster:7.0
    container_name: redis-node-4
    volumes:
      - redis-cluster_data-4:/bitnami/redis/data
    environment:
      # - 'REDIS_PASSWORD=bitnami'
      - REDIS_PORT_NUMBER=7004
      - ALLOW_EMPTY_PASSWORD=yes
      - 'REDIS_NODES=redis-node-0:7000 redis-node-1:7001 redis-node-2:7002 redis-node-3:7003 redis-node-4:7004 redis-node-5:7005'
    ports:
      - "7004:7004"
    networks:
      - redis-cluster_default

  redis-node-5:
    image: docker.io/bitnami/redis-cluster:7.0
    container_name: redis-node-5
    volumes:
      - redis-cluster_data-5:/bitnami/redis/data
    depends_on:
      - redis-node-0
      - redis-node-1
      - redis-node-2
      - redis-node-3
      - redis-node-4
    environment:
      # - 'REDIS_PASSWORD=bitnami'
      # - 'REDISCLI_AUTH=bitnami'
      - REDIS_PORT_NUMBER=7005
      - ALLOW_EMPTY_PASSWORD=yes
      - 'REDIS_CLUSTER_REPLICAS=1'
      - 'REDIS_NODES=redis-node-0:7000 redis-node-1:7001 redis-node-2:7002 redis-node-3:7003 redis-node-4:7004 redis-node-5:7005'
      - 'REDIS_CLUSTER_CREATOR=yes'
    ports:
      - "7005:7005"
    networks:
      - redis-cluster_default

volumes:
  redis-cluster_data-0:
    driver: local
  redis-cluster_data-1:
    driver: local
  redis-cluster_data-2:
    driver: local
  redis-cluster_data-3:
    driver: local
  redis-cluster_data-4:
    driver: local
  redis-cluster_data-5:
    driver: local

networks:
  redis-cluster_default:
    external: false
